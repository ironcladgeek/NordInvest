# NordInvest Configuration Template
# Copy this file to config/local.yaml and customize for your preferences

# Capital Settings
capital:
  starting_capital_eur: 2000
  monthly_deposit_eur: 500

# Risk Tolerance (conservative, moderate, aggressive)
risk:
  tolerance: moderate
  max_position_size_percent: 10
  max_sector_concentration_percent: 20

# Market Preferences
markets:
  included: [nordic, eu] # Options: nordic, eu, us
  excluded_markets: []

  # Instrument type preferences
  included_instruments: [stocks, etfs] # Options: stocks, etfs, funds
  exclude_penny_stocks: true
  min_liquidity_usd: 1000000 # Minimum daily trading volume

# Analysis Preferences
analysis:
  # Signal synthesis weights
  weight_fundamental: 0.35
  weight_technical: 0.35
  weight_sentiment: 0.30

  # Signal thresholds
  buy_threshold: 70
  buy_confidence_threshold: 0.60
  hold_lower_threshold: 40
  hold_upper_threshold: 70

  # Time horizon for predictions
  time_horizon_months: 3

  # Technical analysis indicators (using pandas-ta)
  technical_indicators:
    use_pandas_ta: true  # Use pandas-ta library for calculations
    min_periods_required: 200  # Minimum data points needed

    indicators:
      # RSI - Relative Strength Index
      - name: rsi
        params:
          length: 14
        enabled: true

      # MACD - Moving Average Convergence Divergence
      - name: macd
        params:
          fast: 12
          slow: 26
          signal: 9
        enabled: true

      # Bollinger Bands
      - name: bbands
        params:
          length: 20
          std: 2.0
        enabled: true

      # ATR - Average True Range
      - name: atr
        params:
          length: 14
        enabled: true

      # Simple Moving Averages
      - name: sma
        params:
          length: 20
        enabled: true

      - name: sma
        params:
          length: 50
        enabled: true

      - name: sma
        params:
          length: 200
        enabled: true

      # Exponential Moving Averages (disabled by default)
      - name: ema
        params:
          length: 12
        enabled: false

      - name: ema
        params:
          length: 26
        enabled: false

      # ADX - Average Directional Index (disabled by default)
      - name: adx
        params:
          length: 14
        enabled: false

      # Stochastic Oscillator (disabled by default)
      - name: stoch
        params:
          k: 14
          d: 3
        enabled: false

# Output Preferences
output:
  max_recommendations: 10
  report_format: markdown # Options: markdown, html, json
  include_confidence_scores: true
  include_risk_assessment: true

# Data & Caching
data:
  # Cache expiration times (in hours)
  cache_ttl:
    price_data_market_hours: 1
    price_data_overnight: 24
    news: 4
    fundamentals: 24
    financial_statements: 168 # 7 days

  # News fetching settings
  news:
    max_articles: 50  # Maximum number of articles to fetch per ticker
    target_article_count: 50  # Target number for analysis
    max_age_days: 7  # Maximum age of articles
    use_unified_aggregator: true  # Use unified aggregator with deduplication

    # News sources in priority order
    sources:
      - name: alpha_vantage
        priority: 1  # Fetch first (has sentiment scores)
        max_articles: 50
        enabled: true

      - name: finnhub
        priority: 2  # Fetch if needed to reach target
        max_articles: 50
        enabled: true

  # Sentiment analysis configuration
  sentiment:
    scoring_method: api  # Options: 'local' (FinBERT), 'llm', 'api' (provider-based), 'hybrid'
    llm_fallback: true  # Use LLM if local model fails

    # Local FinBERT model settings (for 'local' or 'hybrid' mode)
    local_model:
      name: ProsusAI/finbert  # Financial sentiment model
      device: auto  # Options: 'auto', 'cpu', 'cuda', 'mps'
      batch_size: 32  # Batch size for processing
      max_length: 512  # Maximum token length

  # API providers (in priority order)
  primary_provider: alpha_vantage # Alpha Vantage Premium: news sentiment + fundamentals + earnings estimates
  backup_providers:
    - yahoo_finance # Yahoo Finance: reliable price data
    - finnhub # Finnhub: analyst recommendations only

database:
  enabled: true
  db_path: data/nordinvest.db

api:
  # Set these via environment variables
  # anthropic_api_key: ${ANTHROPIC_API_KEY}
  # finnhub_api_key: ${FINNHUB_API_KEY}
  # openai_api_key: ${OPENAI_API_KEY}

  # API rate limits and retry settings
  max_retries: 3
  retry_backoff_factor: 2
  timeout_seconds: 30

# Logging
logging:
  level: INFO # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: json # Options: json, text
  log_file: logs/nordinvest.log
  max_log_size_mb: 10
  backup_count: 5

# LLM Configuration
llm:
  provider: anthropic # Options: anthropic, openai, local
  model: claude-sonnet-4-20250514 # e.g., claude-sonnet-4-20250514, gpt-4, etc.
  temperature: 0.7 # 0.0-2.0 (lower = more deterministic, higher = more creative)
  max_tokens: 2000 # Maximum tokens per response (100-8000)
  top_p: 1.0 # Top-p nucleus sampling (0.0-1.0)
  timeout_seconds: 60 # Request timeout in seconds (10-300)
  enable_fallback: true # Fall back to rule-based analysis if LLM fails

# Token Tracking & Cost Monitoring
token_tracker:
  enabled: true # Enable/disable token usage tracking
  daily_limit: 100000 # Daily token usage limit (warn when approaching)
  monthly_limit: 1000000 # Monthly token usage limit
  cost_per_1k_input_tokens: 0.003 # Cost per 1k input tokens in EUR (Anthropic: 0.003)
  cost_per_1k_output_tokens: 0.015 # Cost per 1k output tokens in EUR (Anthropic: 0.015)
  warn_on_daily_usage_percent: 0.8 # Warn when daily usage reaches 80%

# Deployment & Scheduling
deployment:
  run_time: "08:00" # UTC, daily run time
  timezone: Europe/Stockholm
  cost_limit_eur_per_month: 100
  cost_check_interval: daily
